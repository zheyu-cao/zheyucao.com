const Y="http://www.w3.org/2000/svg",S=document.getElementById("dynamic-background-svg");if(S){let p=function(t,s){return Math.random()*(s-t)+t},G=function(t,s,i,e,a,r){const o=[],l=[],n=[],u=Math.PI*2/r;for(let d=0;d<r;d++){const h=d*u;l.push(h);let f=i+p(-e,e)*i;f+=p(0,a)*i,f=Math.max(i*.2,f),n.push(f),o.push({x:t+Math.cos(h)*f,y:s+Math.sin(h)*f})}return{points:o,angles:l,radii:n}},O=function(t){if(t.length<3)return"";let s=`M ${t[0].x} ${t[0].y}`;const i=t.length;for(let e=0;e<i;e++){const a=t[(e-1+i)%i],r=t[e],o=t[(e+1)%i],l=t[(e+2)%i],n=r.x+(o.x-a.x)/6,u=r.y+(o.y-a.y)/6,d=o.x-(l.x-r.x)/6,h=o.y-(l.y-r.y)/6;s+=` C ${n} ${u}, ${d} ${h}, ${o.x} ${o.y}`}return s+=" Z",s},U=function(t){if(t=t.replace(/^#/,""),t.length===3&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),t.length!==6)return null;const s=parseInt(t.substring(0,2),16)/255,i=parseInt(t.substring(2,4),16)/255,e=parseInt(t.substring(4,6),16)/255,a=Math.max(s,i,e),r=Math.min(s,i,e);let o=0,l=0;const n=(a+r)/2;if(a===r)o=l=0;else{const u=a-r;switch(l=n>.5?u/(2-a-r):u/(a+r),a){case s:o=(i-e)/u+(i<e?6:0);break;case i:o=(e-s)/u+2;break;case e:o=(s-i)/u+4;break}o/=6}return{h:Math.round(o*360),s:Math.round(l*100),l:Math.round(n*100)}},j=function(t,s,i){s/=100,i/=100;const e=(1-Math.abs(2*i-1))*s,a=e*(1-Math.abs(t/60%2-1)),r=i-e/2;let o=0,l=0,n=0;0<=t&&t<60?(o=e,l=a,n=0):60<=t&&t<120?(o=a,l=e,n=0):120<=t&&t<180?(o=0,l=e,n=a):180<=t&&t<240?(o=0,l=a,n=e):240<=t&&t<300?(o=a,l=0,n=e):300<=t&&t<360&&(o=e,l=0,n=a),o=Math.round((o+r)*255),l=Math.round((l+r)*255),n=Math.round((n+r)*255);const u=d=>d.toString(16).padStart(2,"0");return`#${u(o)}${u(l)}${u(n)}`},Z=function(t){for(let s=t.length-1;s>0;s--){const i=Math.floor(Math.random()*(s+1));[t[s],t[i]]=[t[i],t[s]]}return t},J=function(){C=[],S.innerHTML="",E=document.createElementNS(Y,"g"),S.appendChild(E);const{width:t,height:s}=S.getBoundingClientRect(),i=window.innerWidth,e=Math.max(c.minScaleFactor,Math.min(c.maxScaleFactor,i/c.referenceWidth)),a=c.baseLargeMinBlobSize*e,r=c.baseLargeMaxBlobSize*e,o=c.baseSmallMinBlobSize*e,l=c.baseSmallMaxBlobSize*e;let n=[];const u=Object.keys(z);if(u.length===0)console.error("No color Scheme defined! Using fallback."),n=["#90EE90","#6BCB77","#3CB371","#32CD32","#a0e9c4"];else{const h=u[Math.floor(Math.random()*u.length)];console.log(`Using scheme: ${h}`);const f=z[h]?[...z[h]]:[];if(f.length===0)console.error(`Selected scheme '${h}' is empty. Using fallback.`),n=["#90EE90","#6BCB77","#3CB371","#32CD32","#a0e9c4"];else{const F=Z(f);n=[];for(let m=0;m<c.numBlobs;m++)n.push(F[m%F.length]);F.length<c.numBlobs&&console.warn(`Scheme '${h}' has only ${F.length} colors. Repeating colors for ${c.numBlobs} blobs.`)}}const d=Math.ceil(c.numBlobs/2);for(let h=0;h<d;h++)T(h,a,r,n[h],t,s);for(let h=d;h<c.numBlobs;h++)T(h,o,l,n[h%n.length],t,s)},T=function(t,s,i,e,a,r){const o=p(s/2,i/2),l={x:p(o,a-o),y:p(o,r-o)},n=U(e);n||console.error(`Invalid initial hex color: ${e}. Skipping blob ${t}.`);const u=G(0,0,o,.3,.2,8),d=O(u.points),h={x:p(-1,1)*c.speedMultiplier,y:p(-1,1)*c.speedMultiplier},f=p(0,360),F=p(-.15,.15),m=document.createElementNS(Y,"path");m.setAttribute("d",d),n?m.setAttribute("fill",e):m.setAttribute("fill","#808080"),m.setAttribute("transform",`translate(${l.x}, ${l.y}) rotate(${f})`),m.style.opacity=String(c.opacity),E.appendChild(m);const Q={id:t,pathElement:m,position:l,velocity:h,radius:o,color:e,hsl:n||{h:0,s:0,l:50},points:u.points,angle:f,angularVelocity:F,baseAngles:u.angles,baseRadii:u.radii,deformationTime:0,deformationSpeed:p(.005,.015),deformationAmplitude:o*p(.05,.15),update:function(L,_,tt,et){this.deformationTime+=1,this.position.x+=this.velocity.x,this.position.y+=this.velocity.y,this.angle+=this.angularVelocity;{this.hsl.h=(this.hsl.h+K+360)%360;const x=j(this.hsl.h,this.hsl.s,this.hsl.l);this.pathElement.setAttribute("fill",x)}if(c.enableMouseInteraction&&L){const x=this.position.x-L.x,y=this.position.y-L.y,B=Math.sqrt(x*x+y*y),g=c.mouseInfluenceRadius+this.radius*1.2;if(B<g){const v=((g-B)/g)**1.5,w=Math.atan2(y,x);this.velocity.x+=Math.cos(w)*v*c.mouseForce*c.speedMultiplier*5,this.velocity.y+=Math.sin(w)*v*c.mouseForce*c.speedMultiplier*5}}const I=Math.sqrt(this.velocity.x**2+this.velocity.y**2),k=1.5*c.speedMultiplier;if(I>k&&(this.velocity.x*=k/I,this.velocity.y*=k/I),this.velocity.x*=.99,this.velocity.y*=.99,c.enableCollisionDetection)for(const y of _){if(this.id===y.id)continue;const B=y.position.x-this.position.x,g=y.position.y-this.position.y,v=Math.sqrt(B*B+g*g),w=(this.radius+y.radius)*.5;if(v<w){const V=w-v,X=Math.atan2(g,B),ot=Math.cos(X)*V*.01,it=Math.sin(X)*V*.01;this.velocity.x-=ot,this.velocity.y-=it}}const q=tt,R=et,$=.05*c.speedMultiplier;this.position.x<this.radius&&(this.velocity.x+=$),this.position.x>q-this.radius&&(this.velocity.x-=$),this.position.y<this.radius&&(this.velocity.y+=$),this.position.y>R-this.radius&&(this.velocity.y-=$),this.position.x=Math.max(this.radius/2,Math.min(q-this.radius/2,this.position.x)),this.position.y=Math.max(this.radius/2,Math.min(R-this.radius/2,this.position.y));const P=.01;Math.abs(this.velocity.x)<P&&Math.abs(this.velocity.y)<P&&Math.abs(this.angularVelocity)<P||this.pathElement.setAttribute("transform",`translate(${this.position.x}, ${this.position.y}) rotate(${this.angle})`)}};C.push(Q)},W=function(){const{width:t,height:s}=S.getBoundingClientRect();E&&(M.x+=(b.x-M.x)*H,M.y+=(b.y-M.y)*H,E.setAttribute("transform",`translate(${M.x}, ${M.y})`)),C.forEach(i=>i.update(A,C,t,s)),requestAnimationFrame(W)};const D="maxTouchPoints"in navigator&&navigator.maxTouchPoints>0||window.innerWidth<1024;console.log(`Lower performance device detected: ${D}`);const c={numBlobs:D?2:4,baseLargeMinBlobSize:1e3,baseLargeMaxBlobSize:1600,baseSmallMinBlobSize:600,baseSmallMaxBlobSize:1e3,referenceWidth:1440,minScaleFactor:.5,maxScaleFactor:1.5,speedMultiplier:D?.5:1,mouseInfluenceRadius:580,mouseForce:-800,opacity:.8,enableCollisionDetection:!D,enableMouseInteraction:!D};let C=[],A=null,E=null;const b={x:0,y:0},M={x:0,y:0},H=.05,N=-.03,z={reds:["#FF6B6B","#FFD93D","#F2bF47","#F2B707","#F28706","#F26430"],oranges:["#FFa700","#FF9B58","#F27149","#F9c443","#faD93D"],yellows:["#FFD700","#FFDB58","#F2E109","#F9D423","#caD93D"],greens:["#90EE90","#6BCB77","#3CB371","#32CD32","#a0e9c4"],cyans:["#40E0D0","#AFEEEE","#7FFFD4","#B3E0F2","#9EfDF2"],blues:["#87CEEB","#64f5ED","#7De6FF","#42d5FF","#7299f9"],forest:["#64f5ED","#F2E109","#32CD32","#32CD32","#a0e9c4"],purples:["#996BcB","#c2aFF7","#8267d7","#FF55ff","#e264d0"],browns:["#8B4513","#A0522D","#D2691E","#DAA520","#8B3030"],winter:["#87CEEB","#64f5ED","#7De6FF","#cccccc","#ffffff"]},K=.4;window.addEventListener("mousemove",t=>{if(c.enableMouseInteraction){const s=S.getBoundingClientRect(),i=t.clientX,e=t.clientY;A={x:i-s.left,y:e-s.top};const a=window.innerWidth/2,r=window.innerHeight/2;b.x=(i-a)*N,b.y=(e-r)*N}}),window.addEventListener("mouseleave",()=>{A=null,b.x=0,b.y=0}),J(),W()}else console.error("Dynamic background SVG container not found.");
