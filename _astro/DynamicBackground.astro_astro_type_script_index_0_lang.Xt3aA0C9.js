const it="http://www.w3.org/2000/svg",v=document.getElementById("dynamic-background-svg");if(v){let st=function(t){M||t!==f&&(t<1||t>4||(console.log(`%cFPS Monitor: Switching to Performance Level ${t}.`,"color: orange; font-weight: bold;"),f=t,o.enableShapeChanging=t===4,o.enableMouseInteraction=t>=2,o.enableCollisionDetection=t>=3))},g=function(t,s){return Math.random()*(s-t)+t},nt=function(t,s,n,i,u,l){const e=[],a=[],c=[],h=Math.PI*2/l;for(let y=0;y<l;y++){const r=y*h;a.push(r);let d=n+g(-i,i)*n;d+=g(0,u)*n,d=Math.max(n*.2,d),c.push(d),e.push({x:t+Math.cos(r)*d,y:s+Math.sin(r)*d})}return{points:e,angles:a,radii:c}},V=function(t){if(t.length<3)return"";let s=`M ${t[0].x} ${t[0].y}`;const n=t.length;for(let i=0;i<n;i++){const u=t[(i-1+n)%n],l=t[i],e=t[(i+1)%n],a=t[(i+2)%n],c=l.x+(e.x-u.x)/6,h=l.y+(e.y-u.y)/6,y=e.x-(a.x-l.x)/6,r=e.y-(a.y-l.y)/6;s+=` C ${c} ${h}, ${y} ${r}, ${e.x} ${e.y}`}return s+=" Z",s},ot=function(t){if(t=t.replace(/^#/,""),t.length===3&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),t.length!==6)return null;const s=parseInt(t.substring(0,2),16)/255,n=parseInt(t.substring(2,4),16)/255,i=parseInt(t.substring(4,6),16)/255,u=Math.max(s,n,i),l=Math.min(s,n,i);let e=0,a=0;const c=(u+l)/2;if(u===l)e=a=0;else{const h=u-l;switch(a=c>.5?h/(2-u-l):h/(u+l),u){case s:e=(n-i)/h+(n<i?6:0);break;case n:e=(i-s)/h+2;break;case i:e=(s-n)/h+4;break}e/=6}return{h:Math.round(e*360),s:Math.round(a*100),l:Math.round(c*100)}},ct=function(t){for(let s=t.length-1;s>0;s--){const n=Math.floor(Math.random()*(s+1));[t[s],t[n]]=[t[n],t[s]]}return t},lt=function(){P=[],v.innerHTML="",w=document.createElementNS(it,"g"),v.appendChild(w);const{width:t,height:s}=v.getBoundingClientRect(),n=window.innerWidth,i=Math.max(o.minScaleFactor,Math.min(o.maxScaleFactor,n/o.referenceWidth)),u=o.baseLargeMinBlobSize*i,l=o.baseLargeMaxBlobSize*i,e=o.baseSmallMinBlobSize*i,a=o.baseSmallMaxBlobSize*i;let c=[];const h=Object.keys(k);if(h.length===0)console.error("No color Scheme defined! Using fallback."),c=["#90EE90","#6BCB77","#3CB371","#32CD32","#a0e9c4"];else{const r=h[Math.floor(Math.random()*h.length)];console.log(`Using scheme: ${r}`);const d=k[r]?[...k[r]]:[];if(d.length===0)console.error(`Selected scheme '${r}' is empty. Using fallback.`),c=["#90EE90","#6BCB77","#3CB371","#32CD32","#a0e9c4"];else{const C=ct(d);c=[];for(let m=0;m<o.numBlobs;m++)c.push(C[m%C.length]);C.length<o.numBlobs&&console.warn(`Scheme '${r}' has only ${C.length} colors. Repeating colors for ${o.numBlobs} blobs.`)}}const y=Math.ceil(o.numBlobs/2);for(let r=0;r<y;r++)X(r,u,l,c[r],t,s);for(let r=y;r<o.numBlobs;r++)X(r,e,a,c[r%c.length],t,s)},X=function(t,s,n,i,u,l){const e=g(s/2,n/2),a={x:g(e,u-e),y:g(e,l-e)},c=ot(i);c||console.error(`Invalid initial hex color: ${i}. Skipping blob ${t}.`);const h=nt(0,0,e,.3,.2,8),y=V(h.points),r={x:g(-1,1)*o.speedMultiplier,y:g(-1,1)*o.speedMultiplier},d=g(0,360),C=g(-.15,.15),m=document.createElementNS(it,"path");m.setAttribute("d",y),c?m.setAttribute("fill",i):m.setAttribute("fill","#808080"),m.setAttribute("transform",`translate(${a.x}, ${a.y}) rotate(${d})`),m.style.opacity=String(o.opacity),w.appendChild(m);const pt={id:t,pathElement:m,position:a,velocity:r,radius:e,color:i,hsl:c||{h:0,s:0,l:50},points:h.points,angle:d,angularVelocity:C,baseAngles:h.angles,baseRadii:h.radii,deformationTime:0,deformationSpeed:g(.005,.015),deformationAmplitude:e*g(.05,.15),update:function(W,gt,mt,yt){if(this.deformationTime+=1,o.enableShapeChanging){const B=[],b=this.baseAngles.length;for(let p=0;p<b;p++){const F=this.baseAngles[p],S=this.baseRadii[p],z=Math.sin(this.deformationTime*this.deformationSpeed+F*3)*this.deformationAmplitude,L=Math.max(S*.3,S+z),N=Math.cos(F)*L,O=Math.sin(F)*L;B.push({x:N,y:O})}const x=V(B);this.pathElement.setAttribute("d",x)}if(this.position.x+=this.velocity.x,this.position.y+=this.velocity.y,this.angle+=this.angularVelocity,o.enableMouseInteraction&&W){const B=this.position.x-W.x,b=this.position.y-W.y,x=Math.sqrt(B*B+b*b),p=o.mouseInfluenceRadius+this.radius*1.2;if(x<p){const F=((p-x)/p)**1.5,S=Math.atan2(b,B);this.velocity.x+=Math.cos(S)*F*o.mouseForce*o.speedMultiplier*5,this.velocity.y+=Math.sin(S)*F*o.mouseForce*o.speedMultiplier*5}}const _=Math.sqrt(this.velocity.x**2+this.velocity.y**2),q=1.5*o.speedMultiplier;if(_>q&&(this.velocity.x*=q/_,this.velocity.y*=q/_),this.velocity.x*=.99,this.velocity.y*=.99,o.enableCollisionDetection)for(const b of gt){if(this.id===b.id)continue;const x=b.position.x-this.position.x,p=b.position.y-this.position.y,F=Math.sqrt(x*x+p*p),S=(this.radius+b.radius)*.5;if(F<S){const z=S-F,L=Math.atan2(p,x),N=Math.cos(L)*z*.01,O=Math.sin(L)*z*.01;this.velocity.x-=N,this.velocity.y-=O}}const tt=mt,et=yt,I=.05*o.speedMultiplier;this.position.x<this.radius&&(this.velocity.x+=I),this.position.x>tt-this.radius&&(this.velocity.x-=I),this.position.y<this.radius&&(this.velocity.y+=I),this.position.y>et-this.radius&&(this.velocity.y-=I),this.position.x=Math.max(this.radius/2,Math.min(tt-this.radius/2,this.position.x)),this.position.y=Math.max(this.radius/2,Math.min(et-this.radius/2,this.position.y));const H=.01;Math.abs(this.velocity.x)<H&&Math.abs(this.velocity.y)<H&&Math.abs(this.angularVelocity)<H||this.pathElement.setAttribute("transform",`translate(${this.position.x}, ${this.position.y}) rotate(${this.angle})`)}};P.push(pt)},Y=function(t){requestAnimationFrame(Y);const s=t-Z;if(s<J)return;Z=t-s%J;const n=t-U;if(U=t,!M&&n>0){const l=1e3/n;if($.push(l),$.length>R&&$.shift(),$.length===R){const e=$.reduce((c,h)=>c+h,0)/R;let a=f;if(e<K?a=1:e<Q?a=2:e<ht?a=3:a=4,a===f)A=0;else{let c=!1;a>f?(f===1&&e>=at||f===2&&e>=rt||f===3&&e>=ut)&&(c=!0):(f===4&&e<ft||f===3&&e<Q||f===2&&e<K)&&(c=!0),c?(A++,A>=dt&&(st(a),A=0)):A=0}console.log(`Avg FPS: ${e.toFixed(1)}, Level: ${f}`)}}const{width:i,height:u}=v.getBoundingClientRect();w&&(E.x+=(D.x-E.x)*j,E.y+=(D.y-E.y)*j,w.setAttribute("transform",`translate(${E.x}, ${E.y})`)),P.forEach(l=>l.update(T,P,i,u))};const M="maxTouchPoints"in navigator&&navigator.maxTouchPoints>0||window.innerWidth<1024;console.log(`Lower performance device detected: ${M}`);const o={numBlobs:M?2:4,baseLargeMinBlobSize:1e3,baseLargeMaxBlobSize:1600,baseSmallMinBlobSize:600,baseSmallMaxBlobSize:1e3,referenceWidth:1440,minScaleFactor:.5,maxScaleFactor:1.5,speedMultiplier:M?.5:1,mouseInfluenceRadius:580,mouseForce:-800,opacity:.8,enableShapeChanging:!1,enableCollisionDetection:!M,enableMouseInteraction:!M};let P=[],T=null,w=null;const D={x:0,y:0},E={x:0,y:0},j=.05,G=-.03;let f=M?1:3;const $=[],R=60;let U=performance.now(),Z=performance.now();const J=1e3/60,K=30,at=35,Q=40,rt=45,ht=55,ut=55,ft=50;let A=0;const dt=30;v.classList.add("css-hue-shift-active");const k={reds:["#FF6B6B","#FFD93D","#F2bF47","#F2B707","#F28706","#F26430"],oranges:["#FFa700","#FF9B58","#F27149","#F9c443","#faD93D"],yellows:["#FFD700","#FFDB58","#F2E109","#F9D423","#caD93D"],greens:["#90EE90","#6BCB77","#3CB371","#32CD32","#a0e9c4"],cyans:["#40E0D0","#AFEEEE","#7FFFD4","#B3E0F2","#9EfDF2"],blues:["#87CEEB","#64f5ED","#7De6FF","#42d5FF","#7299f9"],forest:["#64f5ED","#F2E109","#32CD32","#32CD32","#a0e9c4"],purples:["#996BcB","#c2aFF7","#8267d7","#FF55ff","#e264d0"],browns:["#8B4513","#A0522D","#D2691E","#DAA520","#8B3030"],winter:["#87CEEB","#64f5ED","#7De6FF","#cccccc","#ffffff"]};window.addEventListener("mousemove",t=>{if(o.enableMouseInteraction){const s=v.getBoundingClientRect(),n=t.clientX,i=t.clientY;T={x:n-s.left,y:i-s.top};const u=window.innerWidth/2,l=window.innerHeight/2;D.x=(n-u)*G,D.y=(i-l)*G}}),window.addEventListener("mouseleave",()=>{T=null,D.x=0,D.y=0}),lt(),requestAnimationFrame(Y)}else console.error("Dynamic background SVG container not found.");
