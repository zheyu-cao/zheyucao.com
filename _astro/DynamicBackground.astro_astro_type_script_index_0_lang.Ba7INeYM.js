const it="http://www.w3.org/2000/svg",v=document.getElementById("dynamic-background-svg");if(v){let st=function(t){F||t!==g&&(t<1||t>4||(console.log(`%cFPS Monitor: Switching to Performance Level ${t}.`,"color: orange; font-weight: bold;"),g=t,o.enableShapeChanging=t===4,o.enableMouseInteraction=t>=2,o.enableCollisionDetection=t>=3))},p=function(t,s){return Math.random()*(s-t)+t},nt=function(t,s,n,i,u,a){const e=[],l=[],c=[],h=Math.PI*2/a;for(let y=0;y<a;y++){const r=y*h;l.push(r);let f=n+p(-i,i)*n;f+=p(0,u)*n,f=Math.max(n*.2,f),c.push(f),e.push({x:t+Math.cos(r)*f,y:s+Math.sin(r)*f})}return{points:e,angles:l,radii:c}},V=function(t){if(t.length<3)return"";let s=`M ${t[0].x} ${t[0].y}`;const n=t.length;for(let i=0;i<n;i++){const u=t[(i-1+n)%n],a=t[i],e=t[(i+1)%n],l=t[(i+2)%n],c=a.x+(e.x-u.x)/6,h=a.y+(e.y-u.y)/6,y=e.x-(l.x-a.x)/6,r=e.y-(l.y-a.y)/6;s+=` C ${c} ${h}, ${y} ${r}, ${e.x} ${e.y}`}return s+=" Z",s},ot=function(t){if(t=t.replace(/^#/,""),t.length===3&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),t.length!==6)return null;const s=parseInt(t.substring(0,2),16)/255,n=parseInt(t.substring(2,4),16)/255,i=parseInt(t.substring(4,6),16)/255,u=Math.max(s,n,i),a=Math.min(s,n,i);let e=0,l=0;const c=(u+a)/2;if(u===a)e=l=0;else{const h=u-a;switch(l=c>.5?h/(2-u-a):h/(u+a),u){case s:e=(n-i)/h+(n<i?6:0);break;case n:e=(i-s)/h+2;break;case i:e=(s-n)/h+4;break}e/=6}return{h:Math.round(e*360),s:Math.round(l*100),l:Math.round(c*100)}},ct=function(t){for(let s=t.length-1;s>0;s--){const n=Math.floor(Math.random()*(s+1));[t[s],t[n]]=[t[n],t[s]]}return t},at=function(){I=[],v.innerHTML="",w=document.createElementNS(it,"g"),v.appendChild(w);const{width:t,height:s}=v.getBoundingClientRect(),n=window.innerWidth,i=Math.max(o.minScaleFactor,Math.min(o.maxScaleFactor,n/o.referenceWidth)),u=o.baseLargeMinBlobSize*i,a=o.baseLargeMaxBlobSize*i,e=o.baseSmallMinBlobSize*i,l=o.baseSmallMaxBlobSize*i;let c=[];const h=Object.keys(k);if(h.length===0)console.error("No color Scheme defined! Using fallback."),c=["#90EE90","#6BCB77","#3CB371","#32CD32","#a0e9c4"];else{const r=h[Math.floor(Math.random()*h.length)];console.log(`Using scheme: ${r}`);const f=k[r]?[...k[r]]:[];if(f.length===0)console.error(`Selected scheme '${r}' is empty. Using fallback.`),c=["#90EE90","#6BCB77","#3CB371","#32CD32","#a0e9c4"];else{const C=ct(f);c=[];for(let m=0;m<o.numBlobs;m++)c.push(C[m%C.length]);C.length<o.numBlobs&&console.warn(`Scheme '${r}' has only ${C.length} colors. Repeating colors for ${o.numBlobs} blobs.`)}}const y=Math.ceil(o.numBlobs/2);for(let r=0;r<y;r++)X(r,u,a,c[r],t,s);for(let r=y;r<o.numBlobs;r++)X(r,e,l,c[r%c.length],t,s)},X=function(t,s,n,i,u,a){const e=p(s/2,n/2),l={x:p(e,u-e),y:p(e,a-e)},c=ot(i);c||console.error(`Invalid initial hex color: ${i}. Skipping blob ${t}.`);const h=nt(0,0,e,.3,.2,8),y=V(h.points),r={x:p(-1,1)*o.speedMultiplier,y:p(-1,1)*o.speedMultiplier},f=p(0,360),C=p(-.15,.15),m=document.createElementNS(it,"path");m.setAttribute("d",y),c?m.setAttribute("fill",i):m.setAttribute("fill","#808080"),m.setAttribute("transform",`translate(${l.x}, ${l.y}) rotate(${f})`),m.style.opacity=String(o.opacity),w.appendChild(m);const pt={id:t,pathElement:m,position:l,velocity:r,radius:e,color:i,hsl:c||{h:0,s:0,l:50},points:h.points,angle:f,angularVelocity:C,baseAngles:h.angles,baseRadii:h.radii,deformationTime:0,deformationSpeed:p(.005,.015),deformationAmplitude:e*p(.05,.15),update:function(W,gt,mt,yt){if(this.deformationTime+=1,o.enableShapeChanging){const B=[],b=this.baseAngles.length;for(let d=0;d<b;d++){const M=this.baseAngles[d],S=this.baseRadii[d],z=Math.sin(this.deformationTime*this.deformationSpeed+M*3)*this.deformationAmplitude,L=Math.max(S*.3,S+z),N=Math.cos(M)*L,O=Math.sin(M)*L;B.push({x:N,y:O})}const x=V(B);this.pathElement.setAttribute("d",x)}if(this.position.x+=this.velocity.x,this.position.y+=this.velocity.y,this.angle+=this.angularVelocity,o.enableMouseInteraction&&W){const B=this.position.x-W.x,b=this.position.y-W.y,x=Math.sqrt(B*B+b*b),d=o.mouseInfluenceRadius+this.radius*1.2;if(x<d){const M=((d-x)/d)**1.5,S=Math.atan2(b,B);this.velocity.x+=Math.cos(S)*M*o.mouseForce*o.speedMultiplier*5,this.velocity.y+=Math.sin(S)*M*o.mouseForce*o.speedMultiplier*5}}const _=Math.sqrt(this.velocity.x**2+this.velocity.y**2),q=1.5*o.speedMultiplier;if(_>q&&(this.velocity.x*=q/_,this.velocity.y*=q/_),this.velocity.x*=.99,this.velocity.y*=.99,o.enableCollisionDetection)for(const b of gt){if(this.id===b.id)continue;const x=b.position.x-this.position.x,d=b.position.y-this.position.y,M=Math.sqrt(x*x+d*d),S=(this.radius+b.radius)*.5;if(M<S){const z=S-M,L=Math.atan2(d,x),N=Math.cos(L)*z*.01,O=Math.sin(L)*z*.01;this.velocity.x-=N,this.velocity.y-=O}}const tt=mt,et=yt,P=.05*o.speedMultiplier;this.position.x<this.radius&&(this.velocity.x+=P),this.position.x>tt-this.radius&&(this.velocity.x-=P),this.position.y<this.radius&&(this.velocity.y+=P),this.position.y>et-this.radius&&(this.velocity.y-=P),this.position.x=Math.max(this.radius/2,Math.min(tt-this.radius/2,this.position.x)),this.position.y=Math.max(this.radius/2,Math.min(et-this.radius/2,this.position.y));const H=.01;Math.abs(this.velocity.x)<H&&Math.abs(this.velocity.y)<H&&Math.abs(this.angularVelocity)<H||this.pathElement.setAttribute("transform",`translate(${this.position.x}, ${this.position.y}) rotate(${this.angle})`)}};I.push(pt)},Y=function(t){requestAnimationFrame(Y);const s=t-Z;if(s<J)return;Z=t-s%J;const n=t-U;if(U=t,!F&&n>0){const a=1e3/n;if($.push(a),$.length>R&&$.shift(),$.length===R){const e=$.reduce((c,h)=>c+h,0)/R;let l=g;if(e<K?l=1:e<Q?l=2:e<ht?l=3:l=4,l===g)A=0;else{let c=!1;l>g?(g===1&&e>=lt||g===2&&e>=rt||g===3&&e>=ut)&&(c=!0):(g===4&&e<ft||g===3&&e<Q||g===2&&e<K)&&(c=!0),c?(A++,A>=dt&&(st(l),A=0)):A=0}}}const{width:i,height:u}=v.getBoundingClientRect();w&&(E.x+=(D.x-E.x)*j,E.y+=(D.y-E.y)*j,w.setAttribute("transform",`translate(${E.x}, ${E.y})`)),I.forEach(a=>a.update(T,I,i,u))};const F="maxTouchPoints"in navigator&&navigator.maxTouchPoints>0||window.innerWidth<1024;console.log(`Lower performance device detected: ${F}`);const o={numBlobs:F?2:4,baseLargeMinBlobSize:1e3,baseLargeMaxBlobSize:1600,baseSmallMinBlobSize:600,baseSmallMaxBlobSize:1e3,referenceWidth:1440,minScaleFactor:.5,maxScaleFactor:1.5,speedMultiplier:F?.5:1,mouseInfluenceRadius:580,mouseForce:-800,opacity:.8,enableShapeChanging:!1,enableCollisionDetection:!F,enableMouseInteraction:!F};let I=[],T=null,w=null;const D={x:0,y:0},E={x:0,y:0},j=.05,G=-.03;let g=F?1:3;const $=[],R=60;let U=performance.now(),Z=performance.now();const J=1e3/60,K=30,lt=35,Q=40,rt=45,ht=55,ut=55,ft=50;let A=0;const dt=30;v.classList.add("css-hue-shift-active");const k={reds:["#FF6B6B","#FFD93D","#F2bF47","#F2B707","#F28706","#F26430"],oranges:["#FFa700","#FF9B58","#F27149","#F9c443","#faD93D"],yellows:["#FFD700","#FFDB58","#F2E109","#F9D423","#caD93D"],greens:["#90EE90","#6BCB77","#3CB371","#32CD32","#a0e9c4"],cyans:["#40E0D0","#AFEEEE","#7FFFD4","#B3E0F2","#9EfDF2"],blues:["#87CEEB","#64f5ED","#7De6FF","#42d5FF","#7299f9"],forest:["#64f5ED","#F2E109","#32CD32","#32CD32","#a0e9c4"],purples:["#996BcB","#c2aFF7","#8267d7","#FF55ff","#e264d0"],browns:["#8B4513","#A0522D","#D2691E","#DAA520","#8B3030"],winter:["#87CEEB","#64f5ED","#7De6FF","#cccccc","#ffffff"]};window.addEventListener("mousemove",t=>{if(o.enableMouseInteraction){const s=v.getBoundingClientRect(),n=t.clientX,i=t.clientY;T={x:n-s.left,y:i-s.top};const u=window.innerWidth/2,a=window.innerHeight/2;D.x=(n-u)*G,D.y=(i-a)*G}}),window.addEventListener("mouseleave",()=>{T=null,D.x=0,D.y=0}),at(),requestAnimationFrame(Y)}else console.error("Dynamic background SVG container not found.");
