---
import { Icon } from "astro-icon/components";

interface Props {
  title: string;
  imageSrc?: string;
  imageAlt?: string;
  timeframe?: string;
  projectUrl?: string;
  githubUrl?: string;
  techStack?: string[];
}

const {
  title,
  imageSrc,
  imageAlt = "Project thumbnail", // Default alt text
  timeframe,
  projectUrl,
  githubUrl,
  techStack = [],
} = Astro.props;
---

<article class="project-card scroll-reveal-animate">
  {
    imageSrc && (
      <div class="project-image-wrapper">
        <img src={imageSrc} alt={imageAlt} class="project-image" loading="lazy" />
      </div>
    )
  }
  <div class="project-content">
    <header class="project-header">
      <h3 class="project-title">{title}</h3>
    </header>

    <div class="project-metadata">
      {timeframe && <span class="project-timeframe">{timeframe}</span>}
      {
        techStack.length > 0 && (
          <div class="project-tech-stack">
            {techStack.map((tech) => (
              <span class="tech-tag">{tech}</span>
            ))}
          </div>
        )
      }
      <div class="project-links">
        {
          githubUrl && (
            <a
              href={githubUrl}
              target="_blank"
              rel="noopener noreferrer"
              title="View source on GitHub"
            >
              <Icon name="ri:github-line" /> GitHub
            </a>
          )
        }
        {
          projectUrl && (
            <a href={projectUrl} target="_blank" rel="noopener noreferrer" title="Visit live site">
              <Icon name="ri:external-link-line" /> Live Site
            </a>
          )
        }
      </div>
    </div>

    <div class="project-body">
      <slot />
    </div>
  </div>
</article>

<style>
  .project-card {
    border-radius: 8px;
    border: 1px solid var(--card-border-color);
    overflow: hidden;
    display: flex;
    flex-direction: column;
    transition: all 0.2s ease-out;
    margin-bottom: 3rem; /* Space below card */
  }

  .project-card:hover {
    border-color: var(--card-border-hover-color);
    backdrop-filter: brightness(1.1) saturate(1.1);
  }

  .project-image-wrapper {
    aspect-ratio: 16 / 9; /* Force aspect ratio */
    overflow: hidden;
    background-color: var(--bg-muted); /* Placeholder bg */
  }
  .project-image {
    width: 100%;
    height: 100%;
    object-fit: cover; /* Cover the area, cropping if needed */
    object-position: top;
    display: block;
  }

  .project-content {
    padding: 2rem; /* Increased padding inside card */
    display: flex;
    flex-direction: column;
    flex-grow: 1; /* Allow content to fill remaining space */
  }

  .project-header {
    margin-bottom: 1rem; /* Space below title */
  }
  .project-title {
    font-size: 1.5rem;
    font-weight: 600;
    margin: 0;
    color: var(--heading-color);
    line-height: 1.3;
  }

  .project-metadata {
    margin-bottom: 1.5rem; /* Reduced space below metadata */
    display: flex;
    flex-direction: column;
    gap: 0.8rem; /* Reduced vertical gap between items */
    font-family: var(--font-family-sans); /* Apply sans-serif font */
  }

  .project-timeframe {
    font-size: 0.9rem; /* Slightly smaller timeframe */
    color: var(--text-muted);
    display: block;
    font-family: inherit; /* Inherit sans-serif from parent */
  }

  .project-tech-stack {
    display: flex;
    flex-wrap: wrap;
    gap: 1rem; /* Reduced gap between tags */
    font-family: inherit; /* Inherit sans-serif from parent */
    line-height: 1.4; /* Adjusted line height */
  }

  .tech-tag {
    background-color: var(--tag-bg-color);
    color: var(--tag-text-color);
    font-size: 0.85rem; /* Keep tags slightly smaller */
    padding: 0.2em 0; /* Reduced padding */
    border-radius: 4px;
    font-family: inherit; /* Inherit sans-serif from parent */
  }

  .project-tech-stack:first-child {
    padding-left: 0;
  }

  .project-links {
    display: flex;
    flex-wrap: wrap;
    gap: 1.2rem; /* Slightly reduced gap */
    align-items: center;
    font-family: inherit; /* Inherit sans-serif from parent */
  }
  .project-links a {
    color: var(--link-color);
    text-decoration: none;
    font-size: 0.9rem; /* Align size with timeframe */
    display: inline-flex;
    align-items: center;
    gap: 0.4em;
    transition: color 0.2s ease;
    font-family: inherit; /* Inherit sans-serif from parent */
  }
  .project-links a:hover {
    color: var(--link-hover-color);
    text-decoration: underline;
  }
  .project-links :global(svg) {
    font-size: 1.2em;
  }

  .project-body {
    font-size: 1.1rem;
    line-height: 1.8;
    flex-grow: 1;
  }
  .project-body :global(p) {
    margin-bottom: 1em;
  }
  .project-body :global(ul) {
    padding-left: 1.5em;
    margin-top: 0.5em;
    list-style: disc;
  }
</style>
